<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - CIANET PROVEDOR</title>
    <link id="favicon" rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #f8fafc; }
        .app-layout { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #166534 0%, #15803d 30%, #22c55e 70%, #16a34a 100%);
            color: white;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
            box-shadow: 4px 0 25px rgba(22, 101, 52, 0.3);
        }
        
        .sidebar-brand { padding: 28px 24px; border-bottom: 1px solid rgba(255, 255, 255, 0.15); }
        .sidebar-brand-logo { display: flex; align-items: center; gap: 14px; }
        
        .sidebar-brand-icon {
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, #f97316, #ea580c);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
        }
        
        .sidebar-brand-text h1 { font-size: 20px; font-weight: 700; color: white; }
        .sidebar-brand-text span { font-size: 12px; color: rgba(255, 255, 255, 0.75); }
        
        .sidebar-nav { flex: 1; padding: 20px 16px; overflow-y: auto; }
        .nav-section { margin-bottom: 28px; }
        
        .nav-section-title {
            font-size: 11px; font-weight: 700; text-transform: uppercase;
            letter-spacing: 1.5px; color: rgba(255, 255, 255, 0.5);
            padding: 0 12px; margin-bottom: 12px;
        }
        
        .nav-menu { list-style: none; }
        
        .nav-link {
            display: flex; align-items: center; gap: 14px; padding: 14px 16px;
            color: rgba(255, 255, 255, 0.85); text-decoration: none;
            border-radius: 14px; margin-bottom: 6px;
            transition: all 0.3s ease; font-weight: 500;
        }
        
        .nav-link:hover { background: rgba(255, 255, 255, 0.15); color: white; transform: translateX(4px); }
        .nav-link.active { background: linear-gradient(135deg, #f97316, #ea580c); color: white; box-shadow: 0 8px 20px rgba(249, 115, 22, 0.35); }
        .nav-link i { font-size: 20px; width: 24px; text-align: center; }
        
        .nav-badge {
            margin-left: auto; background: #f97316; color: white;
            font-size: 11px; font-weight: 700; padding: 4px 10px; border-radius: 20px;
        }
        
        .nav-link.active .nav-badge { background: rgba(255, 255, 255, 0.25); }
        
        /* Main Content */
        .main-content { flex: 1; margin-left: 280px; display: flex; flex-direction: column; }
        
        .top-header {
            background: white; padding: 20px 32px;
            display: flex; align-items: center; justify-content: space-between;
            border-bottom: 1px solid #e5e7eb; position: sticky; top: 0;
            z-index: 50; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
        }
        
        .header-search {
            display: flex; align-items: center; gap: 12px;
            background: #f4f4f5; padding: 12px 20px;
            border-radius: 14px; width: 320px; transition: all 0.3s;
        }
        
        .header-search:focus-within { background: white; box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2); }
        .header-search input { border: none; background: transparent; outline: none; font-size: 14px; width: 100%; }
        .header-search i { color: #9ca3af; }
        .header-actions { display: flex; align-items: center; gap: 16px; }
        
        .header-btn {
            width: 44px; height: 44px; border-radius: 14px; border: none;
            background: #f4f4f5; color: #6b7280; cursor: pointer;
            position: relative; transition: all 0.3s;
        }
        
        .header-btn:hover { background: #22c55e; color: white; transform: translateY(-2px); box-shadow: 0 6px 15px rgba(34, 197, 94, 0.3); }
        
        .notification-dot {
            position: absolute; top: 8px; right: 8px; width: 10px; height: 10px;
            background: #f97316; border-radius: 50%; border: 2px solid white;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.2); } }
        
        .user-menu {
            display: flex; align-items: center; gap: 12px;
            padding: 8px 16px 8px 8px; background: linear-gradient(135deg, #f0fdf4, #fff7ed);
            border-radius: 16px; cursor: pointer; border: 2px solid #dcfce7; transition: all 0.3s;
        }
        
        .user-menu:hover { border-color: #22c55e; box-shadow: 0 4px 12px rgba(34, 197, 94, 0.15); }
        
        .user-avatar {
            width: 40px; height: 40px; border-radius: 12px;
            background: linear-gradient(135deg, #22c55e, #f97316); color: white;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 14px;
        }
        
        .user-info { text-align: left; }
        .user-name { font-size: 14px; font-weight: 600; color: #1f2937; }
        .user-role { font-size: 12px; color: #6b7280; }
        
        .page-content { padding: 32px; }
        
        /* Welcome Banner */
        .welcome-banner {
            background: linear-gradient(135deg, #166534 0%, #22c55e 50%, #f97316 100%);
            border-radius: 24px; padding: 36px 40px; color: white;
            margin-bottom: 32px; position: relative; overflow: hidden;
            box-shadow: 0 15px 40px rgba(34, 197, 94, 0.3);
        }
        
        .welcome-banner::before {
            content: ''; position: absolute; top: -50%; right: -20%;
            width: 400px; height: 400px; background: rgba(255, 255, 255, 0.08); border-radius: 50%;
        }
        
        .welcome-content { position: relative; z-index: 1; display: flex; justify-content: space-between; align-items: center; }
        .welcome-text h1 { font-size: 28px; font-weight: 700; margin-bottom: 8px; }
        .welcome-text p { font-size: 15px; opacity: 0.9; }
        
        .live-stats { display: flex; gap: 32px; }
        
        .live-stat {
            text-align: center; padding: 16px 24px;
            background: rgba(255, 255, 255, 0.15); border-radius: 16px;
            backdrop-filter: blur(10px);
        }
        
        .live-stat-value {
            font-size: 32px; font-weight: 700;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        
        .live-stat-value .live-dot {
            width: 10px; height: 10px; background: #4ade80;
            border-radius: 50%; animation: livePulse 1.5s infinite;
        }
        
        @keyframes livePulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(1.2); } }
        
        .live-stat-label { font-size: 12px; opacity: 0.9; margin-top: 4px; }
        
        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-bottom: 32px; }
        
        .stat-card {
            background: white; border-radius: 20px; padding: 28px;
            position: relative; overflow: hidden; border: 1px solid #e5e7eb;
            transition: all 0.4s ease; cursor: pointer;
        }
        
        .stat-card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1); }
        .stat-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; }
        
        .stat-card.green::before { background: linear-gradient(90deg, #22c55e, #4ade80); }
        .stat-card.orange::before { background: linear-gradient(90deg, #f97316, #fb923c); }
        .stat-card.blue::before { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
        .stat-card.purple::before { background: linear-gradient(90deg, #8b5cf6, #a78bfa); }
        
        .stat-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 16px; }
        
        .stat-icon {
            width: 56px; height: 56px; border-radius: 16px;
            display: flex; align-items: center; justify-content: center; font-size: 26px;
        }
        
        .stat-card.green .stat-icon { background: #dcfce7; color: #16a34a; }
        .stat-card.orange .stat-icon { background: #ffedd5; color: #ea580c; }
        .stat-card.blue .stat-icon { background: #dbeafe; color: #2563eb; }
        .stat-card.purple .stat-icon { background: #ede9fe; color: #7c3aed; }
        
        .stat-mini-chart { width: 80px; height: 40px; }
        .stat-value { font-size: 32px; font-weight: 700; color: #18181b; margin-bottom: 4px; }
        .stat-label { font-size: 14px; color: #71717a; margin-bottom: 12px; }
        
        .stat-trend {
            display: inline-flex; align-items: center; gap: 6px;
            padding: 6px 12px; border-radius: 20px; font-size: 13px; font-weight: 600;
        }
        
        .stat-trend.up { background: #dcfce7; color: #16a34a; }
        .stat-trend.down { background: #fee2e2; color: #dc2626; }
        
        /* Dashboard Grid */
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px; }
        
        .card { background: white; border-radius: 20px; border: 1px solid #e5e7eb; overflow: hidden; }
        
        .card-header {
            padding: 24px 28px; border-bottom: 1px solid #f4f4f5;
            display: flex; align-items: center; justify-content: space-between;
        }
        
        .card-title { font-size: 18px; font-weight: 700; color: #18181b; display: flex; align-items: center; gap: 12px; }
        .card-title i { color: #22c55e; font-size: 22px; }
        .card-body { padding: 24px 28px; }
        
        /* Sistema de Filas */
        .queue-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
        .queue-stat { text-align: center; padding: 20px; background: #f9fafb; border-radius: 14px; }
        .queue-stat-value { font-size: 28px; font-weight: 700; color: #18181b; }
        .queue-stat-label { font-size: 12px; color: #6b7280; margin-top: 4px; }
        .queue-stat.urgent .queue-stat-value { color: #dc2626; }
        .queue-stat.high .queue-stat-value { color: #f97316; }
        .queue-stat.normal .queue-stat-value { color: #22c55e; }
        
        .queue-list { max-height: 300px; overflow-y: auto; }
        
        .queue-item {
            display: flex; align-items: center; gap: 14px; padding: 14px;
            background: #fafafa; border-radius: 12px; margin-bottom: 10px;
            border-left: 4px solid #22c55e; transition: all 0.3s;
        }
        
        .queue-item:hover { background: #f0fdf4; transform: translateX(4px); }
        .queue-item.urgent { border-left-color: #dc2626; background: #fef2f2; }
        .queue-item.high { border-left-color: #f97316; background: #fff7ed; }
        
        .queue-avatar {
            width: 42px; height: 42px; border-radius: 10px;
            background: linear-gradient(135deg, #22c55e, #16a34a); color: white;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 14px;
        }
        
        .queue-info { flex: 1; }
        .queue-name { font-size: 14px; font-weight: 600; color: #18181b; }
        .queue-subject { font-size: 12px; color: #6b7280; }
        .queue-meta { text-align: right; }
        .queue-time { font-size: 12px; color: #9ca3af; }
        
        .queue-priority {
            font-size: 10px; font-weight: 700; text-transform: uppercase;
            padding: 4px 8px; border-radius: 6px; margin-top: 4px; display: inline-block;
        }
        
        .queue-priority.urgent { background: #fee2e2; color: #dc2626; }
        .queue-priority.high { background: #ffedd5; color: #ea580c; }
        .queue-priority.normal { background: #dcfce7; color: #16a34a; }
        
        .queue-action-btn {
            padding: 8px 16px; border: none; border-radius: 8px;
            font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.2s;
        }
        
        .queue-action-btn.accept { background: linear-gradient(135deg, #22c55e, #16a34a); color: white; }
        .queue-action-btn.accept:hover { transform: scale(1.05); box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3); }
        
        /* Gr√°ficos */
        .chart-container { position: relative; height: 280px; }
        
        /* Quick Actions */
        .quick-actions { display: grid; grid-template-columns: repeat(5, 1fr); gap: 16px; margin-bottom: 32px; }
        
        .quick-action {
            display: flex; flex-direction: column; align-items: center; gap: 12px;
            padding: 24px 16px; background: white; border: 2px solid #e5e7eb;
            border-radius: 18px; cursor: pointer; transition: all 0.3s; text-decoration: none;
        }
        
        .quick-action:hover { border-color: #22c55e; transform: translateY(-4px); box-shadow: 0 12px 30px rgba(34, 197, 94, 0.15); }
        
        .quick-action-icon {
            width: 56px; height: 56px; border-radius: 16px;
            display: flex; align-items: center; justify-content: center; font-size: 26px;
        }
        
        .quick-action:nth-child(1) .quick-action-icon { background: linear-gradient(135deg, #22c55e, #16a34a); color: white; }
        .quick-action:nth-child(2) .quick-action-icon { background: linear-gradient(135deg, #f97316, #ea580c); color: white; }
        .quick-action:nth-child(3) .quick-action-icon { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
        .quick-action:nth-child(4) .quick-action-icon { background: linear-gradient(135deg, #8b5cf6, #7c3aed); color: white; }
        .quick-action:nth-child(5) .quick-action-icon { background: linear-gradient(135deg, #ec4899, #db2777); color: white; }
        
        .quick-action span { font-size: 14px; font-weight: 600; color: #374151; }
        
        /* Content Grid */
        .content-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 24px; }
        
        /* Activity List */
        .activity-item { display: flex; align-items: flex-start; gap: 14px; padding: 16px 0; border-bottom: 1px solid #f4f4f5; }
        .activity-item:last-child { border-bottom: none; }
        
        .activity-icon {
            width: 40px; height: 40px; border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; flex-shrink: 0;
        }
        
        .activity-icon.chat { background: #dcfce7; color: #16a34a; }
        .activity-icon.user { background: #ffedd5; color: #ea580c; }
        .activity-icon.alert { background: #fee2e2; color: #dc2626; }
        .activity-icon.success { background: #dbeafe; color: #2563eb; }
        
        .activity-content { flex: 1; }
        .activity-title { font-size: 13px; font-weight: 600; color: #18181b; margin-bottom: 2px; }
        .activity-desc { font-size: 12px; color: #71717a; }
        .activity-time { font-size: 11px; color: #a1a1aa; white-space: nowrap; }
        
        /* Agents */
        .agents-list { display: flex; flex-direction: column; gap: 12px; }
        .agent-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: #fafafa; border-radius: 12px; transition: all 0.3s; }
        .agent-item:hover { background: #f0fdf4; }
        
        .agent-avatar {
            width: 40px; height: 40px; border-radius: 10px;
            background: linear-gradient(135deg, #22c55e, #f97316); color: white;
            display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 14px; position: relative;
        }
        
        .agent-status { position: absolute; bottom: -2px; right: -2px; width: 12px; height: 12px; border-radius: 50%; border: 2px solid white; }
        .agent-status.online { background: #22c55e; }
        .agent-status.away { background: #f97316; }
        .agent-status.busy { background: #dc2626; }
        
        .agent-info { flex: 1; }
        .agent-name { font-size: 13px; font-weight: 600; color: #18181b; }
        .agent-role { font-size: 11px; color: #71717a; }
        .agent-chats { padding: 4px 12px; background: #dcfce7; color: #16a34a; font-size: 12px; font-weight: 600; border-radius: 16px; }
        
        /* Performance Ring */
        .performance-ring { width: 120px; height: 120px; margin: 0 auto 16px; position: relative; }
        .performance-ring svg { transform: rotate(-90deg); }
        .performance-ring circle { fill: none; stroke-width: 10; }
        .performance-ring .bg { stroke: #e5e7eb; }
        .performance-ring .progress { stroke: url(#gradient); stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
        .performance-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        .performance-value strong { font-size: 28px; font-weight: 700; color: #18181b; }
        .performance-value span { display: block; font-size: 11px; color: #6b7280; }
        
        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px);
            display: flex; align-items: center; justify-content: center;
            z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.3s;
        }
        
        .modal-overlay.active { opacity: 1; visibility: visible; }
        
        .modal-content {
            background: white; border-radius: 20px; width: 90%; max-width: 900px;
            max-height: 85vh; overflow: hidden; box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            transform: translateY(20px) scale(0.95); transition: all 0.3s;
        }
        
        .modal-overlay.active .modal-content { transform: translateY(0) scale(1); }
        
        .modal-header {
            padding: 24px; background: linear-gradient(135deg, #166534, #22c55e, #f97316);
            color: white; display: flex; align-items: center; justify-content: space-between;
        }
        
        .modal-header h3 { font-size: 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; }
        
        .modal-close {
            width: 36px; height: 36px; border-radius: 10px; border: none;
            background: rgba(255, 255, 255, 0.2); color: white;
            cursor: pointer; font-size: 18px; transition: all 0.2s;
        }
        
        .modal-close:hover { background: rgba(255, 255, 255, 0.3); transform: scale(1.1); }
        .modal-body { padding: 24px; max-height: 60vh; overflow-y: auto; }
        .modal-footer { padding: 16px 24px; border-top: 1px solid #e5e7eb; display: flex; gap: 12px; justify-content: flex-end; }
        
        .report-filters { display: flex; gap: 12px; margin-bottom: 24px; flex-wrap: wrap; }
        .report-filters select, .report-filters input { padding: 10px 14px; border: 2px solid #e5e7eb; border-radius: 10px; font-size: 14px; min-width: 150px; }
        .report-filters select:focus, .report-filters input:focus { outline: none; border-color: #22c55e; }
        
        .report-summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
        .report-stat { text-align: center; padding: 20px; background: #f9fafb; border-radius: 14px; }
        .report-stat-value { font-size: 24px; font-weight: 700; color: #18181b; }
        .report-stat-label { font-size: 12px; color: #6b7280; margin-top: 4px; }
        .report-chart { height: 250px; margin-bottom: 24px; }
        
        .btn {
            padding: 12px 24px; border-radius: 10px; font-size: 14px; font-weight: 600;
            cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 8px; border: none;
        }
        
        .btn-primary { background: linear-gradient(135deg, #22c55e, #16a34a); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(34, 197, 94, 0.3); }
        .btn-secondary { background: #f4f4f5; color: #374151; border: 2px solid #e5e7eb; }
        .btn-secondary:hover { background: #e5e7eb; }
        .btn-orange { background: linear-gradient(135deg, #f97316, #ea580c); color: white; }
        .btn-orange:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(249, 115, 22, 0.3); }
        
        /* Responsivo */
        @media (max-width: 1400px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .content-grid { grid-template-columns: 1fr 1fr; }
            .dashboard-grid { grid-template-columns: 1fr; }
            .quick-actions { grid-template-columns: repeat(3, 1fr); }
            .report-summary { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; }
            .stats-grid, .content-grid { grid-template-columns: 1fr; }
            .quick-actions { grid-template-columns: 1fr; }
            .live-stats { flex-direction: column; gap: 12px; }
            .welcome-content { flex-direction: column; text-align: center; gap: 24px; }
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <div class="sidebar-brand-logo">
                    <div class="sidebar-brand-icon"><i class="bi bi-headset"></i></div>
                    <div class="sidebar-brand-text">
                        <h1>CIANET</h1>
                        <span>Sistema de Atendimento</span>
                    </div>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Principal</div>
                    <ul class="nav-menu">
                        <li><a href="/dashboard" class="nav-link active"><i class="bi bi-grid-1x2-fill"></i><span>Dashboard</span></a></li>
                        <li><a href="/chat" class="nav-link"><i class="bi bi-chat-dots-fill"></i><span>Atendimentos</span><span class="nav-badge" id="chatBadge">0</span></a></li>
                        <li><a href="/whatsapp" class="nav-link"><i class="bi bi-whatsapp"></i><span>WhatsApp</span></a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Gest√£o</div>
                    <ul class="nav-menu">
                        <li><a href="/customers" class="nav-link"><i class="bi bi-people-fill"></i><span>Clientes</span></a></li>
                        <li><a href="#" class="nav-link" onclick="openQueueModal()"><i class="bi bi-list-ol"></i><span>Fila de Espera</span><span class="nav-badge" id="queueBadge">0</span></a></li>
                        <li><a href="/chatbot-admin" class="nav-link"><i class="bi bi-robot"></i><span>Treinar Chatbot</span></a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Relat√≥rios</div>
                    <ul class="nav-menu">
                        <li><a href="#" class="nav-link" onclick="openReportsModal()"><i class="bi bi-graph-up-arrow"></i><span>Relat√≥rios</span></a></li>
                        <li><a href="#" class="nav-link" onclick="openPerformanceModal()"><i class="bi bi-speedometer2"></i><span>Performance</span></a></li>
                    </ul>
                </div>
                
                <div class="nav-section">
                    <div class="nav-section-title">Sistema</div>
                    <ul class="nav-menu">
                        <li><a href="#" class="nav-link"><i class="bi bi-gear-fill"></i><span>Configura√ß√µes</span></a></li>
                        <li><a href="/login" class="nav-link" onclick="localStorage.clear(); sessionStorage.clear();"><i class="bi bi-box-arrow-left"></i><span>Sair</span></a></li>
                    </ul>
                </div>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <header class="top-header">
                <div class="header-search">
                    <i class="bi bi-search"></i>
                    <input type="text" placeholder="Buscar clientes, conversas...">
                </div>
                
                <div class="header-actions">
                    <button class="header-btn" onclick="openReportsModal()" title="Relat√≥rios">
                        <i class="bi bi-graph-up"></i>
                    </button>
                    <button class="header-btn" title="Notifica√ß√µes">
                        <i class="bi bi-bell-fill"></i>
                        <span class="notification-dot"></span>
                    </button>
                    <div class="user-menu">
                        <div class="user-avatar" id="userAvatar">AD</div>
                        <div class="user-info">
                            <div class="user-name" id="userName">Administrador</div>
                            <div class="user-role" id="userRole">Admin</div>
                        </div>
                    </div>
                </div>
            </header>
            
            <div class="page-content">
                <!-- Welcome Banner -->
                <div class="welcome-banner">
                    <div class="welcome-content">
                        <div class="welcome-text">
                            <h1>üëã Bem-vindo, <span id="welcomeName">Administrador</span>!</h1>
                            <p>Acompanhe o desempenho em tempo real do seu sistema de atendimento</p>
                        </div>
                        <div class="live-stats">
                            <div class="live-stat">
                                <div class="live-stat-value"><span class="live-dot"></span> <span id="liveConversations">12</span></div>
                                <div class="live-stat-label">Conversas Ativas</div>
                            </div>
                            <div class="live-stat">
                                <div class="live-stat-value" id="liveWaiting">3</div>
                                <div class="live-stat-label">Aguardando</div>
                            </div>
                            <div class="live-stat">
                                <div class="live-stat-value" id="liveSatisfaction">98%</div>
                                <div class="live-stat-label">Satisfa√ß√£o</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card green" onclick="window.location.href='/chat'">
                        <div class="stat-header">
                            <div class="stat-icon"><i class="bi bi-chat-dots-fill"></i></div>
                            <canvas id="miniChart1" class="stat-mini-chart"></canvas>
                        </div>
                        <div class="stat-value" id="statConversations">1,234</div>
                        <div class="stat-label">Conversas Hoje</div>
                        <span class="stat-trend up"><i class="bi bi-arrow-up"></i> +12%</span>
                    </div>
                    <div class="stat-card orange" onclick="window.location.href='/customers'">
                        <div class="stat-header">
                            <div class="stat-icon"><i class="bi bi-people-fill"></i></div>
                            <canvas id="miniChart2" class="stat-mini-chart"></canvas>
                        </div>
                        <div class="stat-value" id="statCustomers">10,000</div>
                        <div class="stat-label">Clientes Ativos</div>
                        <span class="stat-trend up"><i class="bi bi-arrow-up"></i> +127</span>
                    </div>
                    <div class="stat-card blue">
                        <div class="stat-header">
                            <div class="stat-icon"><i class="bi bi-robot"></i></div>
                            <canvas id="miniChart3" class="stat-mini-chart"></canvas>
                        </div>
                        <div class="stat-value" id="statBotRate">78%</div>
                        <div class="stat-label">Resolvidos pelo Bot</div>
                        <span class="stat-trend up"><i class="bi bi-arrow-up"></i> +5%</span>
                    </div>
                    <div class="stat-card purple">
                        <div class="stat-header">
                            <div class="stat-icon"><i class="bi bi-clock-fill"></i></div>
                            <canvas id="miniChart4" class="stat-mini-chart"></canvas>
                        </div>
                        <div class="stat-value" id="statAvgTime">2:30</div>
                        <div class="stat-label">Tempo M√©dio Resposta</div>
                        <span class="stat-trend down"><i class="bi bi-arrow-down"></i> -15s</span>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions">
                    <a href="/chat" class="quick-action">
                        <div class="quick-action-icon"><i class="bi bi-plus-lg"></i></div>
                        <span>Nova Conversa</span>
                    </a>
                    <a href="/customers" class="quick-action">
                        <div class="quick-action-icon"><i class="bi bi-person-plus"></i></div>
                        <span>Novo Cliente</span>
                    </a>
                    <a href="/chatbot-admin" class="quick-action">
                        <div class="quick-action-icon"><i class="bi bi-cpu"></i></div>
                        <span>Treinar Bot</span>
                    </a>
                    <a href="#" class="quick-action" onclick="openReportsModal()">
                        <div class="quick-action-icon"><i class="bi bi-file-earmark-bar-graph"></i></div>
                        <span>Relat√≥rios</span>
                    </a>
                    <a href="#" class="quick-action" onclick="openQueueModal()">
                        <div class="quick-action-icon"><i class="bi bi-list-check"></i></div>
                        <span>Fila de Espera</span>
                    </a>
                </div>
                
                <!-- Dashboard Grid -->
                <div class="dashboard-grid">
                    <!-- Sistema de Filas -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="bi bi-list-ol"></i> Fila de Atendimento</h3>
                            <button class="btn btn-primary" onclick="openQueueModal()" style="padding: 8px 16px; font-size: 12px;">
                                <i class="bi bi-eye"></i> Ver Todos
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="queue-stats">
                                <div class="queue-stat urgent">
                                    <div class="queue-stat-value" id="queueUrgent">2</div>
                                    <div class="queue-stat-label">Urgentes</div>
                                </div>
                                <div class="queue-stat high">
                                    <div class="queue-stat-value" id="queueHigh">5</div>
                                    <div class="queue-stat-label">Alta Prioridade</div>
                                </div>
                                <div class="queue-stat normal">
                                    <div class="queue-stat-value" id="queueNormal">8</div>
                                    <div class="queue-stat-label">Normal</div>
                                </div>
                            </div>
                            <div class="queue-list" id="queueList"></div>
                        </div>
                    </div>
                    
                    <!-- Gr√°fico -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="bi bi-bar-chart-fill"></i> Atendimentos por Hora</h3>
                            <select id="chartPeriod" onchange="updateMainChart()" style="padding: 8px 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 13px;">
                                <option value="today">Hoje</option>
                                <option value="week">√öltima Semana</option>
                                <option value="month">√öltimo M√™s</option>
                            </select>
                        </div>
                        <div class="card-body">
                            <div class="chart-container">
                                <canvas id="mainChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Grid -->
                <div class="content-grid">
                    <!-- Atividade Recente -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="bi bi-activity"></i> Atividade Recente</h3>
                        </div>
                        <div class="card-body">
                            <div id="activityList"></div>
                        </div>
                    </div>
                    
                    <!-- Agentes Online -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="bi bi-headset"></i> Equipe Online</h3>
                            <span style="background: #dcfce7; color: #16a34a; padding: 4px 12px; border-radius: 16px; font-size: 12px; font-weight: 600;" id="agentsOnlineCount">4 online</span>
                        </div>
                        <div class="card-body">
                            <div class="agents-list" id="agentsList"></div>
                        </div>
                    </div>
                    
                    <!-- Performance -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title"><i class="bi bi-speedometer2"></i> Performance</h3>
                        </div>
                        <div class="card-body" style="text-align: center;">
                            <div class="performance-ring">
                                <svg width="120" height="120">
                                    <defs>
                                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                            <stop offset="0%" style="stop-color:#22c55e"/>
                                            <stop offset="100%" style="stop-color:#f97316"/>
                                        </linearGradient>
                                    </defs>
                                    <circle class="bg" cx="60" cy="60" r="50"/>
                                    <circle class="progress" cx="60" cy="60" r="50" id="performanceCircle" stroke-dasharray="314" stroke-dashoffset="62.8"/>
                                </svg>
                                <div class="performance-value">
                                    <strong id="performanceValue">80%</strong>
                                    <span>Meta: 85%</span>
                                </div>
                            </div>
                            <div style="margin-top: 20px;">
                                <div style="font-size: 14px; font-weight: 600; color: #18181b; margin-bottom: 8px;">Indicadores</div>
                                <div style="display: flex; justify-content: space-around; font-size: 12px; color: #6b7280;">
                                    <div><span style="color: #22c55e;">‚óè</span> SLA: 95%</div>
                                    <div><span style="color: #f97316;">‚óè</span> NPS: 72</div>
                                    <div><span style="color: #3b82f6;">‚óè</span> FCR: 88%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Modal de Relat√≥rios -->
    <div class="modal-overlay" id="reportsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="bi bi-graph-up-arrow"></i> Relat√≥rios e M√©tricas</h3>
                <button class="modal-close" onclick="closeReportsModal()"><i class="bi bi-x-lg"></i></button>
            </div>
            <div class="modal-body">
                <div class="report-filters">
                    <select id="reportType">
                        <option value="conversations">Conversas</option>
                        <option value="agents">Desempenho Agentes</option>
                        <option value="satisfaction">Satisfa√ß√£o</option>
                        <option value="bot">Chatbot</option>
                    </select>
                    <input type="date" id="reportDateFrom">
                    <input type="date" id="reportDateTo">
                    <button class="btn btn-primary" onclick="generateReport()">
                        <i class="bi bi-play-fill"></i> Gerar
                    </button>
                </div>
                
                <div class="report-summary">
                    <div class="report-stat">
                        <div class="report-stat-value" id="reportTotal">3,456</div>
                        <div class="report-stat-label">Total de Atendimentos</div>
                    </div>
                    <div class="report-stat">
                        <div class="report-stat-value" id="reportResolved">3,210</div>
                        <div class="report-stat-label">Resolvidos</div>
                    </div>
                    <div class="report-stat">
                        <div class="report-stat-value" id="reportAvgTime">2:45</div>
                        <div class="report-stat-label">Tempo M√©dio</div>
                    </div>
                    <div class="report-stat">
                        <div class="report-stat-value" id="reportSatisfaction">96%</div>
                        <div class="report-stat-label">Satisfa√ß√£o</div>
                    </div>
                </div>
                
                <div class="report-chart">
                    <canvas id="reportChart"></canvas>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="exportReport('excel')">
                    <i class="bi bi-file-earmark-excel"></i> Exportar Excel
                </button>
                <button class="btn btn-orange" onclick="exportReport('pdf')">
                    <i class="bi bi-file-earmark-pdf"></i> Exportar PDF
                </button>
            </div>
        </div>
    </div>
    
    <!-- Modal de Fila -->
    <div class="modal-overlay" id="queueModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3><i class="bi bi-list-ol"></i> Fila de Atendimento</h3>
                <button class="modal-close" onclick="closeQueueModal()"><i class="bi bi-x-lg"></i></button>
            </div>
            <div class="modal-body">
                <div class="queue-stats" style="margin-bottom: 24px;">
                    <div class="queue-stat urgent">
                        <div class="queue-stat-value" id="modalQueueUrgent">2</div>
                        <div class="queue-stat-label">Urgentes</div>
                    </div>
                    <div class="queue-stat high">
                        <div class="queue-stat-value" id="modalQueueHigh">5</div>
                        <div class="queue-stat-label">Alta Prioridade</div>
                    </div>
                    <div class="queue-stat normal">
                        <div class="queue-stat-value" id="modalQueueNormal">8</div>
                        <div class="queue-stat-label">Normal</div>
                    </div>
                </div>
                <div class="queue-list" id="modalQueueList" style="max-height: 400px;"></div>
            </div>
        </div>
    </div>

    <script>
        const API_URL = '/api/v1';
        let mainChart = null, reportChart = null;
        
        const queueData = [
            { id: 1, name: 'Carlos Mendes', subject: 'Internet sem conex√£o', priority: 'urgent', time: '5 min' },
            { id: 2, name: 'Ana Paula Silva', subject: 'Lentid√£o na conex√£o', priority: 'urgent', time: '8 min' },
            { id: 3, name: 'Roberto Costa', subject: 'D√∫vida sobre fatura', priority: 'high', time: '12 min' },
            { id: 4, name: 'Fernanda Lima', subject: 'Upgrade de plano', priority: 'high', time: '15 min' },
            { id: 5, name: 'Jos√© Santos', subject: '2¬™ via de boleto', priority: 'normal', time: '18 min' },
            { id: 6, name: 'Maria Oliveira', subject: 'Altera√ß√£o de endere√ßo', priority: 'normal', time: '22 min' }
        ];
        
        const activityData = [
            { type: 'chat', title: 'Nova conversa', desc: 'Jo√£o Silva - Internet lenta', time: '2 min' },
            { type: 'user', title: 'Upgrade realizado', desc: 'Maria Santos - Plano Premium', time: '15 min' },
            { type: 'alert', title: 'Chamado t√©cnico', desc: 'Regi√£o Centro - Instabilidade', time: '32 min' },
            { type: 'success', title: 'Bot resolveu', desc: 'D√∫vida sobre 2¬™ via', time: '45 min' }
        ];
        
        const agentsData = [
            { name: 'Administrador', role: 'Supervisor', initials: 'AD', status: 'online', chats: 3 },
            { name: 'Carlos Andrade', role: 'Atendente', initials: 'CA', status: 'online', chats: 5 },
            { name: 'Julia Ferreira', role: 'Atendente', initials: 'JF', status: 'online', chats: 4 },
            { name: 'Roberto Silva', role: 'T√©cnico', initials: 'RS', status: 'away', chats: 2 }
        ];
        
        document.addEventListener('DOMContentLoaded', () => {
            const token = localStorage.getItem('access_token') || sessionStorage.getItem('access_token');
            if (!token) { window.location.href = '/login'; return; }
            
            loadUserInfo();
            renderQueue();
            renderActivity();
            renderAgents();
            initCharts();
            
            setInterval(updateLiveStats, 10000);
        });
        
        function loadUserInfo() {
            const user = JSON.parse(localStorage.getItem('user') || sessionStorage.getItem('user') || '{}');
            if (user.nome) {
                document.getElementById('userName').textContent = user.nome;
                document.getElementById('welcomeName').textContent = user.nome.split(' ')[0];
                document.getElementById('userRole').textContent = user.role || 'Usu√°rio';
                document.getElementById('userAvatar').textContent = user.nome.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
            }
        }
        
        function renderQueue() {
            const container = document.getElementById('queueList');
            const modalContainer = document.getElementById('modalQueueList');
            
            const urgentCount = queueData.filter(q => q.priority === 'urgent').length;
            const highCount = queueData.filter(q => q.priority === 'high').length;
            const normalCount = queueData.filter(q => q.priority === 'normal').length;
            
            document.getElementById('queueUrgent').textContent = urgentCount;
            document.getElementById('queueHigh').textContent = highCount;
            document.getElementById('queueNormal').textContent = normalCount;
            document.getElementById('queueBadge').textContent = queueData.length;
            
            if (document.getElementById('modalQueueUrgent')) {
                document.getElementById('modalQueueUrgent').textContent = urgentCount;
                document.getElementById('modalQueueHigh').textContent = highCount;
                document.getElementById('modalQueueNormal').textContent = normalCount;
            }
            
            const html = queueData.slice(0, 4).map(item => renderQueueItem(item)).join('');
            container.innerHTML = html;
            if (modalContainer) modalContainer.innerHTML = queueData.map(item => renderQueueItem(item)).join('');
        }
        
        function renderQueueItem(item) {
            const initials = item.name.split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
            const priorityLabels = { urgent: 'Urgente', high: 'Alta', normal: 'Normal' };
            return `<div class="queue-item ${item.priority}">
                <div class="queue-avatar">${initials}</div>
                <div class="queue-info">
                    <div class="queue-name">${item.name}</div>
                    <div class="queue-subject">${item.subject}</div>
                </div>
                <div class="queue-meta">
                    <div class="queue-time">‚è±Ô∏è ${item.time}</div>
                    <span class="queue-priority ${item.priority}">${priorityLabels[item.priority]}</span>
                </div>
                <button class="queue-action-btn accept" onclick="acceptFromQueue(${item.id})">
                    <i class="bi bi-check-lg"></i> Atender
                </button>
            </div>`;
        }
        
        function acceptFromQueue(id) {
            const item = queueData.find(q => q.id === id);
            if (item) { alert(`Iniciando atendimento com ${item.name}\nAssunto: ${item.subject}`); window.location.href = '/chat'; }
        }
        
        function renderActivity() {
            document.getElementById('activityList').innerHTML = activityData.map(item => `
                <div class="activity-item">
                    <div class="activity-icon ${item.type}">
                        <i class="bi bi-${item.type === 'chat' ? 'chat-dots' : (item.type === 'user' ? 'person-check' : (item.type === 'alert' ? 'exclamation-triangle' : 'check-circle'))}"></i>
                    </div>
                    <div class="activity-content">
                        <div class="activity-title">${item.title}</div>
                        <div class="activity-desc">${item.desc}</div>
                    </div>
                    <div class="activity-time">${item.time}</div>
                </div>
            `).join('');
        }
        
        function renderAgents() {
            const onlineCount = agentsData.filter(a => a.status === 'online').length;
            document.getElementById('agentsOnlineCount').textContent = `${onlineCount} online`;
            document.getElementById('agentsList').innerHTML = agentsData.map(agent => `
                <div class="agent-item">
                    <div class="agent-avatar">${agent.initials}<span class="agent-status ${agent.status}"></span></div>
                    <div class="agent-info">
                        <div class="agent-name">${agent.name}</div>
                        <div class="agent-role">${agent.role}</div>
                    </div>
                    <div class="agent-chats">${agent.chats}</div>
                </div>
            `).join('');
        }
        
        function initCharts() {
            const miniData = [12, 19, 15, 25, 22, 30, 28];
            const miniOptions = {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { x: { display: false }, y: { display: false } },
                elements: { point: { radius: 0 }, line: { tension: 0.4 } }
            };
            
            ['miniChart1', 'miniChart2', 'miniChart3', 'miniChart4'].forEach((id, i) => {
                const colors = ['#22c55e', '#f97316', '#3b82f6', '#8b5cf6'];
                new Chart(document.getElementById(id), {
                    type: 'line',
                    data: { labels: ['', '', '', '', '', '', ''], datasets: [{ data: miniData.map(d => d + Math.random() * 10), borderColor: colors[i], borderWidth: 2, fill: false }] },
                    options: miniOptions
                });
            });
            
            mainChart = new Chart(document.getElementById('mainChart'), {
                type: 'bar',
                data: {
                    labels: ['08h', '09h', '10h', '11h', '12h', '13h', '14h', '15h', '16h', '17h', '18h'],
                    datasets: [
                        { label: 'Atendimentos', data: [12, 45, 67, 89, 54, 43, 78, 92, 65, 45, 23], backgroundColor: 'rgba(34, 197, 94, 0.8)', borderRadius: 8 },
                        { label: 'Resolvidos Bot', data: [8, 32, 45, 62, 38, 29, 54, 68, 48, 32, 15], backgroundColor: 'rgba(249, 115, 22, 0.8)', borderRadius: 8 }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, padding: 20 } } },
                    scales: { y: { beginAtZero: true, grid: { color: '#f4f4f5' } }, x: { grid: { display: false } } }
                }
            });
            
            updatePerformance(80);
        }
        
        function updateMainChart() {
            const period = document.getElementById('chartPeriod').value;
            let labels, data1, data2;
            
            if (period === 'today') {
                labels = ['08h', '09h', '10h', '11h', '12h', '13h', '14h', '15h', '16h', '17h', '18h'];
                data1 = [12, 45, 67, 89, 54, 43, 78, 92, 65, 45, 23];
                data2 = [8, 32, 45, 62, 38, 29, 54, 68, 48, 32, 15];
            } else if (period === 'week') {
                labels = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'];
                data1 = [245, 312, 287, 356, 298, 189, 145];
                data2 = [178, 234, 198, 267, 212, 134, 98];
            } else {
                labels = ['Sem 1', 'Sem 2', 'Sem 3', 'Sem 4'];
                data1 = [1245, 1456, 1387, 1523];
                data2 = [934, 1098, 1023, 1167];
            }
            
            mainChart.data.labels = labels;
            mainChart.data.datasets[0].data = data1;
            mainChart.data.datasets[1].data = data2;
            mainChart.update();
        }
        
        function updateLiveStats() {
            document.getElementById('liveConversations').textContent = 10 + Math.floor(Math.random() * 10);
            document.getElementById('liveWaiting').textContent = Math.floor(Math.random() * 8);
            document.getElementById('liveSatisfaction').textContent = (94 + Math.floor(Math.random() * 6)) + '%';
        }
        
        function updatePerformance(value) {
            const circle = document.getElementById('performanceCircle');
            const offset = 314 - (value / 100) * 314;
            circle.style.strokeDashoffset = offset;
            document.getElementById('performanceValue').textContent = value + '%';
        }
        
        function openReportsModal() { document.getElementById('reportsModal').classList.add('active'); initReportChart(); }
        function closeReportsModal() { document.getElementById('reportsModal').classList.remove('active'); }
        function openQueueModal() { renderQueue(); document.getElementById('queueModal').classList.add('active'); }
        function closeQueueModal() { document.getElementById('queueModal').classList.remove('active'); }
        function openPerformanceModal() { alert('Painel de Performance detalhado em desenvolvimento.'); }
        
        function initReportChart() {
            if (reportChart) reportChart.destroy();
            reportChart = new Chart(document.getElementById('reportChart'), {
                type: 'line',
                data: {
                    labels: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15'],
                    datasets: [
                        { label: 'Atendimentos', data: [120, 145, 132, 178, 165, 189, 201, 187, 210, 198, 225, 234, 212, 245, 256], borderColor: '#22c55e', backgroundColor: 'rgba(34, 197, 94, 0.1)', fill: true, tension: 0.4 },
                        { label: 'Satisfa√ß√£o (%)', data: [92, 94, 91, 95, 93, 96, 97, 95, 98, 96, 97, 98, 96, 97, 98], borderColor: '#f97316', backgroundColor: 'rgba(249, 115, 22, 0.1)', fill: true, tension: 0.4, yAxisID: 'y1' }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { position: 'bottom', labels: { usePointStyle: true } } },
                    scales: { y: { beginAtZero: false, position: 'left' }, y1: { beginAtZero: false, position: 'right', min: 80, max: 100, grid: { display: false } } }
                }
            });
        }
        
        function generateReport() {
            document.getElementById('reportTotal').textContent = (3000 + Math.floor(Math.random() * 1000)).toLocaleString();
            document.getElementById('reportResolved').textContent = (2800 + Math.floor(Math.random() * 500)).toLocaleString();
            document.getElementById('reportAvgTime').textContent = `${2 + Math.floor(Math.random() * 2)}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`;
            document.getElementById('reportSatisfaction').textContent = (94 + Math.floor(Math.random() * 5)) + '%';
            if (reportChart) { reportChart.data.datasets[0].data = reportChart.data.datasets[0].data.map(() => 100 + Math.floor(Math.random() * 200)); reportChart.update(); }
        }
        
        function exportReport(format) {
            if (format === 'excel') {
                let csv = 'Data,Atendimentos,Satisfa√ß√£o,Tempo M√©dio\n';
                for (let i = 1; i <= 15; i++) csv += `2026-02-${i.toString().padStart(2, '0')},${150 + Math.floor(Math.random() * 100)},${94 + Math.floor(Math.random() * 5)}%,2:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}\n`;
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `relatorio_cianet_${new Date().toISOString().split('T')[0]}.csv`;
                link.click();
                alert('Relat√≥rio Excel exportado!');
            } else {
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`<html><head><title>Relat√≥rio CIANET</title><style>body{font-family:Arial,sans-serif;padding:40px}h1{color:#22c55e;border-bottom:3px solid #f97316;padding-bottom:10px}.stats{display:grid;grid-template-columns:repeat(4,1fr);gap:20px;margin:30px 0}.stat{text-align:center;padding:20px;background:#f4f4f5;border-radius:10px}.stat-value{font-size:28px;font-weight:bold;color:#18181b}.stat-label{font-size:12px;color:#666;margin-top:5px}</style></head><body><h1>üìä Relat√≥rio de Atendimentos - CIANET</h1><p><strong>Per√≠odo:</strong> √öltimos 15 dias | <strong>Gerado em:</strong> ${new Date().toLocaleDateString('pt-BR')}</p><div class="stats"><div class="stat"><div class="stat-value">${document.getElementById('reportTotal').textContent}</div><div class="stat-label">Total</div></div><div class="stat"><div class="stat-value">${document.getElementById('reportResolved').textContent}</div><div class="stat-label">Resolvidos</div></div><div class="stat"><div class="stat-value">${document.getElementById('reportAvgTime').textContent}</div><div class="stat-label">Tempo M√©dio</div></div><div class="stat"><div class="stat-value">${document.getElementById('reportSatisfaction').textContent}</div><div class="stat-label">Satisfa√ß√£o</div></div></div></body></html>`);
                printWindow.document.close();
                printWindow.print();
            }
        }
    </script>
</body>
</html>
